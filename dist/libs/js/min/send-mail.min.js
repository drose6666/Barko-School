const form=document.getElementById('contact-form');function nameValid(field){const $name=document.querySelector(field)
   const nameVal=$name?.value.trim()
   const nameRegex=/^[A-zА-я\s_ ][^0-9]+$/;if($name)
   if(nameVal===''){errorHandler(!0,$name,'Это обязательное поле')
   return!0}else if(!nameRegex.test(nameVal)){errorHandler(!0,$name,'Имя может содержать только буквы')
   return!0}else{errorHandler(!1,$name,'')
   return!1}}
   function phoneValid(field){const $phone=document.querySelector(field)
   const phoneVal=$phone?.value.trim()
   const phoneRegex=/^(\s*)?(\+)?([- _():+]?\d[- _():+]?){11,14}(\s*)?$/;if($phone)
   if(phoneVal===''){errorHandler(!0,$phone,'Это обязательное поле')
   return!0}else if(!phoneRegex.test(phoneVal)){errorHandler(!0,$phone,'Введите корректный номер телефона')
   return!0}else{errorHandler(!1,$phone,'')
   return!1}}
   function emailValid(field){const $email=document.querySelector(field)
   const emailVal=$email?.value.trim()
   const emailRegex=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
   if($email)
   if(emailVal===''){errorHandler(!0,$email,'Это обязательное поле')
   return!0}else if(!emailRegex.test(emailVal)){errorHandler(!0,$email,'Введите email вида example@gmail.com')
   return!0}else{errorHandler(!1,$email,'')
   return!1}}
   function messageValid(field){const $message=document.querySelector(field)
   const messageVal=$message?.value.trim()
   if($message)
   if(messageVal===''){errorHandler(!0,$message,'Это обязательное поле')
   return!0}else if(messageVal.length>3000){errorHandler(!0,$message,'Не более 3000 символов')
   return!0}else{errorHandler(!1,$message,'')
   return!1}}
   function ticketsField(field){const $tickets=document.querySelector(field)
   const ticketsVal=$tickets?.value.trim()
   if($tickets)
   if(ticketsVal===''){errorHandler(!0,$tickets,'Это обязательное поле')
   return!0}else{errorHandler(!1,$tickets,'')
   return!1}}
   function errorHandler(error,field,message){const fieldParent=field.parentNode
   const fieldError=fieldParent.querySelector('.error-message')
   if(error){fieldParent.classList.add('error')
   fieldError.textContent=message}else{fieldParent.classList.remove('error')
   fieldError.textContent=''}}
   function validForm(name,phone,email,tickets,message){let nameRes=nameValid(name);let phoneRes=phoneValid(phone);let emailRes=emailValid(email);let messageRes=messageValid(message);let ticketsRes;tickets?ticketsRes=ticketsField(tickets):null
   return(nameRes||phoneRes||emailRes||ticketsRes||messageRes)?!1:!0}
   function sendForm(){const formData=new FormData(form);const isValid=validForm('[data-valid="name"]','[data-valid="phone"]','[data-valid="email"]','[data-valid="tickets"]','[data-valid="message"]')
   if(isValid){fetch('../../libs/mail.php',{method:'POST',body:formData}).then(response=>{if(response.ok){for(let item of form.querySelectorAll('[data-valid]')){item.value=''}
   new openPopup({popup:'#success-popup',close:'#success-popup .ui-close',closeItem:'#success-popup .confirm--btn',openFlag:!0,overlay:'#success-popup .popup-overlay'})}else{new openPopup({popup:'#error-popup',close:'#error-popup .ui-close',closeItem:'#error-popup .confirm--btn',openFlag:!0,overlay:'#error-popup .popup-overlay'})}}).catch(error=>{new openPopup({popup:'#error-popup',close:'#error-popup .ui-close',closeItem:'#error-popup .confirm--btn',openFlag:!0,overlay:'#error-popup .popup-overlay'})})}}
   for(let el of document.querySelectorAll('.field')){el.addEventListener('focus',()=>{errorHandler(!1,el,'')})}
   form.addEventListener('submit',(event)=>{event.preventDefault();sendForm()})